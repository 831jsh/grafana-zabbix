{"version":3,"sources":["../../src/panel-triggers/migrations.js"],"names":["migratePanelSchema","panel","isEmptyPanel","schemaVersion","getSchemaVersion","datasources","datasource","targets","triggers"],"mappings":";;;;;AAAO,WAASA,kBAAT,CAA4BC,KAA5B,EAAmC;AACxC,QAAIC,aAAaD,KAAb,CAAJ,EAAyB;AACvB,aAAOA,KAAP;AACD;;AAED,QAAME,gBAAgBC,iBAAiBH,KAAjB,CAAtB;AACA,YAAQE,aAAR;AACE,WAAK,CAAL;AACEF,cAAMI,WAAN,GAAoB,CAACJ,MAAMK,UAAP,CAApB;AACAL,cAAMM,OAAN,GAAgB,EAAhB;AACAN,cAAMM,OAAN,CAAcN,MAAMI,WAAN,CAAkB,CAAlB,CAAd,IAAsCJ,MAAMO,QAA5C;;AAEA;AACA,eAAOP,MAAMO,QAAb;AACA,eAAOP,MAAMK,UAAb;AACA;AATJ;;AAYA,WAAOL,KAAP;AACD;;gCAnBeD,kB;;AAqBhB,WAASI,gBAAT,CAA0BH,KAA1B,EAAiC;AAC/B,WAAOA,MAAME,aAAN,IAAuB,CAA9B;AACD;;AAED,WAASD,YAAT,CAAsBD,KAAtB,EAA6B;AAC3B,WAAO,CAACA,MAAMK,UAAP,IAAqB,CAACL,MAAMI,WAA5B,IAA2C,CAACJ,MAAMO,QAAlD,IAA8D,CAACP,MAAMM,OAA5E;AACD","file":"migrations.js","sourcesContent":["export function migratePanelSchema(panel) {\n  if (isEmptyPanel(panel)) {\n    return panel;\n  }\n\n  const schemaVersion = getSchemaVersion(panel);\n  switch (schemaVersion) {\n    case 1:\n      panel.datasources = [panel.datasource];\n      panel.targets = {};\n      panel.targets[panel.datasources[0]] = panel.triggers;\n\n      // delete old props\n      delete panel.triggers;\n      delete panel.datasource;\n      break;\n  }\n\n  return panel;\n}\n\nfunction getSchemaVersion(panel) {\n  return panel.schemaVersion || 1;\n}\n\nfunction isEmptyPanel(panel) {\n  return !panel.datasource && !panel.datasources && !panel.triggers && !panel.targets;\n}\n"]}